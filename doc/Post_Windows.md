# 在 Windows 系统实现自动上报

功能原理：使用系统自带的“任务计划程序”实现定时启动

## 第一步：打开“任务计划程序”界面

1. 按快捷键Win+R，弹出运行界面，输入`taskschd.msc`后按回车

## 第二步：新建定时启动任务

2. 双击左侧的“任务计划程序（本地）”展开菜单，然后点击“任务计划程序库”展开已经设置的计划，然后点击窗口右侧的“创建基本任务”。
3. 在弹出的窗口中输入任务的名称，起一个你觉得合适的就行，例如`健康数据提交`。输入完成点击“下一步”
4. 触发器界面：默认即可（选择每天），点击“下一步”。
5. 开始后边有两个时间选择框，日期选择当天就可以；时间选择你每天想让程序定时启动的时间，例如08:00:00；每隔`1`天发生一次。点击“下一步”。
6. 选择“启动程序”，点击“下一步”。
7. 配置启动程序与路径
   1. “程序或脚本”输入框填写`python`(假如已经为Python添加环境变量，否则填整个路径)。
   2. “添加参数”输入框填写主程序的文件名，默认为`HealthDataPost.py`。
   3. “起始于”输入框填写主程序的路径，无需指定文件名，例如`D:\health-data-post-run\`。
   4. 填写完成之后点击“下一步”。
8. “完成”界面：如果你担心一次启动不能成功提交，想设置每天启动多次，那么可以勾选`当单击“完成”时，打开此任务属性的对话框`，并点击“完成”（注意：程序会自动判断，因此不会导致当天多次提交）；否则请直接点击“完成”。
   1. 如果您勾选了`当单击“完成”时，打开此任务属性的对话框`，请继续往下看这一部分，否则请直接看"第三步：测试是否正常"
   2. 在新弹出的定时任务属性窗口中，选择“触发器”选项卡，然后点击下方的“新建”，选择“每天”，并且在“开始”字样右边的输入框中设置启动时间。日期选择当天就可以；时间选择你每天想让程序定时启动的时间，例如10:00:00；选择之后点击“确定”。
   3. 确定你所设置无误时，点击“确定”。

## 第三步：测试是否正常

选中刚才创建的任务 ，点击右侧的“运行”进行测试，如果弹出命令行界面并正常输出程序运行日志，则代表正常。

## 第四步：设置电脑不自动进入睡眠模式

1. 打开控制面板
2. 右上角选择“类别”
3. 点击“硬件和声音”
4. 在“电源选项”下面选择“更改计算机睡眠时间”
5. 把“使计算机进入睡眠状态：” 设置为从不（“用电池”以及“接通电源”两者都要设置）
6. 点击“保存修改”

## 第五步：注意电脑不要关机

不要让电脑关机，否则程序无法定时启动。

要保证到了提交健康数据的时间电脑要保持运行状态。